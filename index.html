<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MISL ERP | Support Tracking System</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    <!-- Dexie -->
    <script src="https://unpkg.com/dexie/dist/dexie.js"></script>
    <!-- Firebase (for Cloud Sync) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Tailwind Config for Custom Colors -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                        }
                    },
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>

<body
    class="text-gray-800 antialiased h-screen flex overflow-hidden selection:bg-brand-500 selection:text-white bg-[#fafafa]">

    <!-- Background Decorative Blobs -->
    <div
        class="fixed top-[-10%] left-[-10%] w-[40%] h-[40%] bg-brand-100/30 rounded-full blur-[120px] pointer-events-none z-0">
    </div>
    <div
        class="fixed bottom-[-10%] right-[-10%] w-[35%] h-[35%] bg-sky-100/40 rounded-full blur-[100px] pointer-events-none z-0">
    </div>

    <!-- Sidebar -->
    <aside
        class="w-20 lg:w-72 bg-white flex flex-col transition-all duration-300 z-20 shadow-[4px_0_24px_rgba(0,0,0,0.02)]">
        <!-- Logo area -->
        <div class="h-24 flex items-center justify-center lg:justify-start lg:px-8">
            <div class="h-10 w-10 flex items-center justify-center text-brand-600 bg-brand-50 rounded-xl p-2">
                <svg viewBox="0 0 100 100" class="h-full w-full">
                    <path d="M50 5 L90 27.5 L90 72.5 L50 95 L10 72.5 L10 27.5 Z" fill="none" stroke="currentColor"
                        stroke-width="12" stroke-linejoin="round" />
                    <path d="M50 35 L70 46.5 L70 67.5 L50 79 L30 67.5 L30 46.5 Z" fill="currentColor" />
                </svg>
            </div>
            <div class="ml-3 hidden lg:block">
                <h1 class="font-bold text-lg text-gray-800 leading-tight">MISL ERP</h1>
                <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Support</p>
            </div>
        </div>

        <!-- Nav Links -->
        <nav class="flex-1 py-4 flex flex-col gap-1 px-4">
            <a href="#" onclick="app.showSection('dashboard')" id="nav-dashboard"
                class="nav-item active flex items-center gap-4 px-4 py-3.5 rounded-xl text-brand-600 bg-brand-50/80 font-semibold transition-all group">
                <i class="fa-solid fa-chart-pie text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">Dashboard</span>
            </a>
            <a href="#" onclick="app.showSection('calls')" id="nav-calls"
                class="nav-item flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-400 hover:bg-gray-50 hover:text-brand-600 transition-all group">
                <i class="fa-solid fa-phone text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">Active Call</span>
            </a>
            <a href="#" onclick="app.showSection('activities')" id="nav-activities"
                class="nav-item flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-400 hover:bg-gray-50 hover:text-brand-600 transition-all group">
                <i
                    class="fa-solid fa-list-check text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">My Tasks</span>
            </a>
            <a href="#" onclick="app.showSection('tickets')" id="nav-tickets"
                class="nav-item flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-400 hover:bg-gray-50 hover:text-brand-600 transition-all group">
                <i class="fa-solid fa-ticket text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">Tickets</span>
            </a>
            <a href="#" onclick="app.showSection('casenotes')" id="nav-casenotes"
                class="nav-item flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-400 hover:bg-gray-50 hover:text-brand-600 transition-all group">
                <i class="fa-solid fa-book-open text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">Daily Case Notes</span>
            </a>
            <a href="#" onclick="app.showSection('departments')" id="nav-departments"
                class="nav-item flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-400 hover:bg-gray-50 hover:text-brand-600 transition-all group">
                <i
                    class="fa-solid fa-building-user text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">Departments</span>
            </a>
            <a href="#" onclick="app.showSection('users')" id="nav-users"
                class="nav-item hidden flex items-center gap-4 px-4 py-3.5 rounded-xl text-gray-400 hover:bg-gray-50 hover:text-brand-600 transition-all group">
                <i class="fa-solid fa-users text-xl w-6 text-center group-hover:scale-110 transition-transform"></i>
                <span class="hidden lg:block text-[15px] font-bold">Users</span>
            </a>
        </nav>

        <!-- User Profile (Bottom) -->
        <div class="p-6">
            <div
                class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100 group transition-all">
                <div class="flex items-center gap-3 overflow-hidden">
                    <img src="https://ui-avatars.com/api/?name=User&background=6366f1&color=fff" id="sidebar-avatar"
                        class="h-10 w-10 rounded-xl shadow-sm" alt="Profile">
                    <div class="hidden lg:block overflow-hidden">
                        <p class="text-[15px] font-bold text-slate-800 truncate" id="sidebar-username">User</p>
                        <p class="text-[11px] font-bold text-slate-400 uppercase tracking-tight" id="sidebar-role">
                            Online</p>
                    </div>
                </div>
                <button onclick="app.logout()"
                    class="flex items-center gap-2 px-3 py-1.5 rounded-lg text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all font-bold text-[11px] uppercase tracking-wider"
                    title="Logout">
                    <span>Logout</span>
                    <i class="fa-solid fa-right-from-bracket"></i>
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-full relative overflow-hidden bg-gray-50/30">
        <!-- Top Header -->
        <header class="h-24 bg-transparent flex items-center justify-between px-10 z-10">
            <h2 id="page-title" class="text-2xl font-bold text-gray-800 tracking-tight">Overview</h2>
            <div class="flex items-center gap-6">
                <!-- Search -->
                <div class="hidden md:flex relative group">
                    <input type="text" id="global-search" placeholder="Search anything (e.g. Client name)..."
                        oninput="app.handleSearch(this.value)"
                        class="pl-12 pr-6 py-3 w-80 rounded-full bg-white border-transparent focus:border-brand-500/20 focus:ring-4 focus:ring-brand-500/5 outline-none text-sm transition-all shadow-sm shadow-black/5">
                    <i
                        class="fa-solid fa-magnifying-glass absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-brand-500"></i>
                </div>
                <!-- Action Buttons -->
                <div class="flex items-center gap-3">
                    <button onclick="app.showSection('tickets'); app.showAddTicketModal()"
                        class="bg-brand-500 text-white px-6 py-2.5 rounded-xl text-sm font-bold hover:bg-brand-600 transition-all shadow-lg shadow-brand-500/20 active:scale-95">
                        New Ticket
                    </button>
                    <button
                        class="h-11 w-11 rounded-xl bg-white flex items-center justify-center text-gray-400 hover:text-brand-600 transition-all shadow-sm border border-gray-100">
                        <i class="fa-regular fa-bell text-lg"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Scrollable Content Area -->
        <div class="flex-1 overflow-y-auto p-10 pt-2 scroll-smooth" id="main-scroll">

            <!-- DASHBOARD SECTION -->
            <section id="section-dashboard" class="space-y-8 animate-fade-in">
                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                    <!-- Today's Calls -->
                    <div onclick="app.showSection('calls')"
                        class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 group hover:shadow-md transition-all cursor-pointer">
                        <div class="flex justify-between items-start relative z-10">
                            <div>
                                <p class="text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1">Today's
                                    Calls</p>
                                <h3 class="text-3xl font-bold text-slate-800" id="dash-calls-count">0</h3>
                            </div>
                            <div
                                class="h-10 w-10 bg-brand-50 rounded-xl flex items-center justify-center text-brand-500">
                                <i class="fa-solid fa-phone-volume text-lg"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 w-full h-16 pointer-events-none opacity-40">
                            <canvas id="calls-sparkline"></canvas>
                        </div>
                    </div>

                    <!-- Pending Tasks -->
                    <div onclick="app.showSection('activities')"
                        class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 group hover:shadow-md transition-all cursor-pointer">
                        <div class="flex justify-between items-start relative z-10">
                            <div>
                                <p class="text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1">Pending
                                    Tasks</p>
                                <h3 class="text-3xl font-bold text-slate-800" id="dash-tasks-count">0</h3>
                            </div>
                            <div
                                class="h-10 w-10 bg-orange-50 rounded-xl flex items-center justify-center text-orange-500">
                                <i class="fa-solid fa-list-check text-lg"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 w-full h-16 pointer-events-none opacity-40">
                            <canvas id="tasks-sparkline"></canvas>
                        </div>
                    </div>

                    <!-- Open Tickets -->
                    <div onclick="app.showSection('tickets')"
                        class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 group hover:shadow-md transition-all cursor-pointer">
                        <div class="flex justify-between items-start relative z-10">
                            <div>
                                <p class="text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1">Open
                                    Tickets</p>
                                <h3 class="text-3xl font-bold text-slate-800" id="dash-tickets-count">0</h3>
                            </div>
                            <div class="h-10 w-10 bg-rose-50 rounded-xl flex items-center justify-center text-rose-500">
                                <i class="fa-solid fa-ticket text-lg"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 w-full h-16 pointer-events-none opacity-40">
                            <canvas id="tickets-sparkline"></canvas>
                        </div>
                    </div>

                    <!-- Completed Tickets -->
                    <div onclick="app.showSection('tickets')"
                        class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 group hover:shadow-md transition-all cursor-pointer">
                        <div class="flex justify-between items-start relative z-10">
                            <div>
                                <p class="text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1">Completed
                                    Tickets</p>
                                <h3 class="text-3xl font-bold text-slate-800" id="dash-completed-count">0</h3>
                            </div>
                            <div
                                class="h-10 w-10 bg-emerald-50 rounded-xl flex items-center justify-center text-emerald-500">
                                <i class="fa-solid fa-circle-check text-lg"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 w-full h-16 pointer-events-none opacity-40">
                            <div class="h-full w-full bg-gradient-to-t from-emerald-50 to-transparent"></div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 xl:grid-cols-5 gap-8">
                    <!-- Performance Chart -->
                    <div class="xl:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                        <div class="flex justify-between items-center mb-8">
                            <h3 class="text-xl font-bold text-gray-800">Daily Performance</h3>
                            <button onclick="app.showSection('activities')"
                                class="text-sm font-bold text-brand-500 hover:text-brand-600 transition-colors">View
                                All</button>
                        </div>
                        <div class="h-80 relative">
                            <canvas id="performance-chart"></canvas>
                        </div>
                    </div>

                    <!-- Recent Recordings Table -->
                    <div class="xl:col-span-3 bg-white p-8 rounded-[2rem] shadow-sm shadow-black/5 border border-white">
                        <div class="flex justify-between items-center mb-8">
                            <h3 class="text-xl font-bold text-gray-800">Recent Recordings</h3>
                            <button onclick="app.showSection('calls')"
                                class="text-sm font-bold text-brand-500 hover:text-brand-600 transition-colors">View
                                All</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr
                                        class="text-[11px] uppercase text-gray-400 font-bold tracking-widest border-b border-gray-50">
                                        <th class="pb-4 px-2">User</th>
                                        <th class="pb-4 px-2">Client</th>
                                        <th class="pb-4 px-2">Date</th>
                                        <th class="pb-4 px-2">Duration</th>
                                        <th class="pb-4 px-2">Time</th>
                                        <th class="pb-4 px-2 text-right">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-recordings-list" class="text-[14px] divide-y divide-gray-50/50">
                                    <!-- Dynamic Rows -->
                                </tbody>
                            </table>
                            <div id="dash-empty-state" class="hidden py-12 text-center text-gray-400">
                                <i class="fa-solid fa-inbox text-4xl mb-3 opacity-30"></i>
                                <p class="font-medium">No recent recordings found.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


            <!-- USERS SECTION (Admin Only) -->
            <section id="section-users" class="hidden animate-fade-in max-w-4xl mx-auto">
                <div class="glass p-8 rounded-3xl shadow-lg border border-white/60">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">Manage Team</h3>
                        <button onclick="app.showAddUserModal()"
                            class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm hover:bg-gray-800 transition-colors">
                            + Add User
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="users-list">
                        <!-- Dynamic Users List -->
                    </div>
                </div>
            </section>

            <!-- CALLS SECTION -->
            <section id="section-calls" class="hidden animate-fade-in h-full">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 h-full max-h-[80vh]">
                    <!-- Call Interface -->
                    <div
                        class="glass p-8 rounded-3xl flex flex-col items-center justify-center text-center relative overflow-hidden shadow-lg border border-white/60">
                        <div
                            class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-brand-500 via-purple-500 to-pink-500">
                        </div>

                        <!-- Status Badge -->
                        <div id="recording-status"
                            class="mb-4 px-3 py-1 rounded-full bg-gray-100 text-gray-500 text-xs font-bold uppercase tracking-wider transition-colors">
                            Ready
                        </div>

                        <!-- Timer Circle -->
                        <div class="relative mb-8">
                            <div
                                class="w-56 h-56 rounded-full border-8 border-gray-50 flex items-center justify-center relative z-10 bg-white shadow-inner">
                                <span id="timer-display"
                                    class="text-5xl font-mono font-bold text-gray-700 tracking-wider">00:00</span>
                            </div>
                            <div id="pulse-ring" class="absolute inset-0 rounded-full bg-red-500 opacity-0 z-0"></div>
                        </div>

                        <!-- Controls -->
                        <div class="w-full max-w-sm space-y-4">
                            <!-- Mic Selection -->
                            <div class="relative">
                                <i
                                    class="fa-solid fa-microphone-lines absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                <select id="mic-select"
                                    class="w-full pl-12 pr-10 py-3 rounded-xl bg-gray-50 border border-gray-100 focus:bg-white focus:ring-2 focus:ring-brand-500 outline-none transition-all font-medium text-gray-700 shadow-inner appearance-none truncate">
                                    <option value="">Default Microphone</option>
                                </select>
                                <i
                                    class="fa-solid fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 text-xs pointer-events-none"></i>
                            </div>

                            <div class="relative">
                                <i
                                    class="fa-regular fa-user absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                <input type="text" id="client-name-input" placeholder="Enter Client Name"
                                    class="w-full pl-12 pr-4 py-4 rounded-xl bg-gray-50 border border-gray-100 focus:bg-white focus:ring-2 focus:ring-brand-500 outline-none transition-all font-medium text-gray-700 placeholder-gray-400 shadow-inner">
                            </div>

                            <div class="flex gap-4 justify-center pt-2">
                                <button id="btn-record" onclick="app.toggleRecording()"
                                    class="flex-1 py-4 px-6 rounded-xl bg-gray-900 text-white font-bold hover:bg-gray-800 active:scale-95 transition-all flex items-center justify-center gap-3 shadow-lg hover:shadow-xl">
                                    <i class="fa-solid fa-microphone"></i> <span id="btn-record-text">Start Rec</span>
                                </button>
                                <button id="btn-save" onclick="app.saveRecording()" disabled
                                    class="flex-1 py-4 px-6 rounded-xl bg-brand-500 text-white font-bold hover:bg-brand-600 active:scale-95 transition-all flex items-center justify-center gap-3 shadow-lg hover:shadow-brand-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none">
                                    <i class="fa-solid fa-floppy-disk"></i> <span>Save</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Recordings List -->
                    <div class="glass p-6 rounded-2xl flex flex-col h-full shadow-lg border border-white/60">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-gray-800">Saved Recordings</h3>
                            <button onclick="app.loadRecordings()"
                                class="p-2 rounded-lg hover:bg-gray-100 text-gray-500 transition-colors"
                                title="Refresh">
                                <i class="fa-solid fa-rotate-right"></i>
                            </button>
                        </div>
                        <div class="overflow-y-auto flex-1 pr-2 space-y-3 custom-scrollbar" id="recordings-list">
                            <!-- Recording Items will be injected here -->
                            <div class="text-center py-10 text-gray-400">
                                <p>No recordings yet.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ACTIVITIES SECTION -->
            <section id="section-activities" class="hidden animate-fade-in max-w-4xl mx-auto">
                <div class="glass p-8 rounded-3xl shadow-lg border border-white/60">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">My Tasks</h3>
                        <span id="task-count-badge"
                            class="bg-brand-100 text-brand-600 py-1 px-3 rounded-full text-xs font-bold">0
                            Pending</span>
                    </div>

                    <!-- Add Task -->
                    <div class="flex gap-2 mb-8">
                        <div class="relative flex-1">
                            <input type="text" id="new-task-input" placeholder="Add a new task..."
                                class="w-full pl-5 pr-4 py-3 rounded-xl bg-gray-50 border border-gray-100 focus:bg-white focus:ring-2 focus:ring-brand-500 outline-none transition-all shadow-inner">
                        </div>
                        <button onclick="app.addTask()"
                            class="bg-brand-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-brand-600 transition-colors shadow-lg shadow-brand-500/20 active:scale-95">
                            <i class="fa-solid fa-plus"></i>
                        </button>
                    </div>

                    <!-- Task Lists -->
                    <div id="tasks-list" class="space-y-3">
                        <!-- Tasks go here -->
                    </div>
                </div>
            </section>

            <!-- TICKETS SECTION -->
            <section id="section-tickets" class="hidden animate-fade-in -mx-6 -mt-6 h-full flex flex-col bg-slate-50">
                <!-- Premium Header -->
                <div class="px-8 py-5 flex justify-between items-center bg-white border-b border-slate-200">
                    <div>
                        <div class="flex items-center gap-3">
                            <h3 class="text-2xl font-bold text-slate-800">Support Tickets</h3>
                            <span
                                class="px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-50 text-indigo-600 uppercase">Kanban
                                Board</span>
                        </div>
                        <p class="text-[13px] text-slate-400 font-medium">Manage and track active support requests</p>
                    </div>
                    <div class="flex gap-3 mb-1">
                        <select id="ticket-filter-department" onchange="app.loadTickets()"
                            class="px-4 py-2.5 rounded-2xl bg-white/80 border-transparent focus:border-indigo-500 transition-all font-bold text-[15px] shadow-sm outline-none">
                            <option value="">All Departments</option>
                        </select>
                        <button onclick="app.deleteClosedTickets()" id="btn-delete-closed"
                            class="hidden px-4 py-2 rounded-xl bg-rose-50 text-rose-600 hover:bg-rose-100 transition-all flex items-center gap-2 font-bold text-xs">
                            <i class="fa-solid fa-trash-can"></i>
                            Clear
                        </button>
                        <button onclick="app.exportTickets()"
                            class="px-4 py-2 rounded-xl bg-white text-slate-600 hover:bg-slate-50 transition-all flex items-center gap-2 font-bold text-xs border border-slate-200">
                            <i class="fa-solid fa-file-export text-indigo-500"></i>
                            Export
                        </button>
                        <button onclick="app.showAddTicketModal()"
                            class="px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition-all flex items-center gap-2 font-bold text-xs shadow-sm">
                            <i class="fa-solid fa-plus"></i>
                            New Ticket
                        </button>
                    </div>
                </div>

                <div class="p-8 flex-1 overflow-hidden">
                    <div id="tickets-kanban-board"
                        class="flex gap-4 overflow-x-auto pb-6 h-full custom-scrollbar items-start">
                        <!-- Kanban columns will be injected here -->
                    </div>
                    <div id="tickets-empty-state" class="hidden py-12 text-center text-gray-500">
                        <i class="fa-solid fa-ticket text-3xl mb-3 opacity-30"></i>
                        <p class="font-medium">No tickets found.</p>
                    </div>
                </div>
            </section>

            <!-- DEPARTMENTS SECTION -->
            <section id="section-departments" class="hidden animate-fade-in max-w-4xl mx-auto py-10 px-4">
                <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-center mb-10">
                        <div>
                            <h3 class="text-2xl font-bold text-slate-800">Department Management</h3>
                            <p class="text-gray-500 font-medium">Create and manage internal departments</p>
                        </div>
                        <span id="department-count-badge"
                            class="bg-slate-100 text-slate-600 py-1.5 px-3 rounded-lg text-[10px] font-bold uppercase tracking-wider">0
                            Total</span>
                    </div>

                    <!-- Add Department -->
                    <div class="flex gap-3 mb-10">
                        <div class="relative flex-1">
                            <input type="text" id="new-department-input"
                                placeholder="Enter department name (e.g. Technical Support)..."
                                class="w-full pl-6 pr-4 py-4 rounded-2xl bg-gray-50 border border-transparent focus:bg-white focus:ring-4 focus:ring-brand-500/5 focus:border-brand-500/20 outline-none transition-all font-medium">
                        </div>
                        <button onclick="app.addDepartment()"
                            class="bg-brand-500 text-white px-8 py-4 rounded-2xl font-bold hover:bg-brand-600 transition-all shadow-lg shadow-brand-500/20 active:scale-95 flex items-center gap-2">
                            <i class="fa-solid fa-plus"></i>
                            ADD
                        </button>
                    </div>

                    <!-- Departments List -->
                    <div id="departments-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Departments go here -->
                    </div>

                    <div id="departments-empty-state" class="hidden py-20 text-center">
                        <div
                            class="h-20 w-20 mx-auto bg-gray-50 rounded-3xl flex items-center justify-center text-gray-300 mb-4">
                            <i class="fa-solid fa-building-user text-3xl"></i>
                        </div>
                        <p class="text-gray-400 font-bold">No departments added yet.</p>
                    </div>
                </div>
            </section>

            <!-- DAILY CASE NOTES SECTION -->
            <section id="section-users" class="hidden animate-fade-in max-w-4xl mx-auto py-10 px-4">
                <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-center mb-10">
                        <div>
                            <h3 class="text-2xl font-bold text-slate-800">User Management</h3>
                            <p class="text-gray-500 font-medium">Create and manage system users and permissions</p>
                        </div>
                        <button onclick="app.showAddUserModal()"
                            class="bg-brand-500 text-white px-6 py-2.5 rounded-xl text-sm font-bold hover:bg-brand-600 transition-all shadow-lg shadow-brand-500/20 active:scale-95 flex items-center gap-2">
                            <i class="fa-solid fa-user-plus"></i>
                            Add User
                        </button>
                    </div>

                    <div id="users-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Users go here -->
                    </div>
                </div>
            </section>

            <!-- DAILY CASE NOTES SECTION -->
            <section id="section-casenotes" class="hidden animate-fade-in h-full overflow-y-auto">
                <div class="glass p-8 rounded-3xl shadow-lg border border-white/60">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800">Daily Case Notes</h3>
                            <p class="text-sm text-gray-500">Track your daily work updates</p>
                        </div>
                        <button onclick="app.showAddCaseNoteModal()"
                            class="bg-brand-600 text-white px-6 py-2.5 rounded-xl text-sm font-bold hover:bg-brand-700 active:scale-95 transition-all shadow-lg shadow-brand-500/20">
                            + New Note
                        </button>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50/50 text-gray-500 text-xs uppercase font-semibold">
                                <tr>
                                    <th class="p-4 rounded-l-xl">Date</th>
                                    <th class="p-4">Type</th>
                                    <th class="p-4">Client</th>
                                    <th class="p-4">Notes</th>
                                    <th class="p-4 rounded-r-xl text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="casenotes-list" class="text-sm divide-y divide-gray-50">
                                <!-- Dynamic content -->
                            </tbody>
                        </table>
                        <div id="casenotes-empty-state" class="hidden py-12 text-center text-gray-400">
                            <i class="fa-solid fa-book text-3xl mb-3 opacity-50"></i>
                            <p>No case notes found.</p>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- Login Modal -->
    <div id="login-modal"
        class="fixed inset-0 bg-transparent backdrop-blur-[2px] z-50 flex items-center justify-center transition-all duration-500 hidden opacity-0">
        <div
            class="glass w-full max-w-sm p-10 rounded-[2.5rem] shadow-[0_32px_64px_-12px_rgba(0,0,0,0.1)] border border-white/80 animate-fade-in">
            <div class="text-center mb-8">
                <div
                    class="h-20 w-20 mx-auto flex items-center justify-center text-brand-600 bg-brand-50 rounded-2xl mb-6 shadow-sm shadow-brand-500/10 p-4">
                    <svg viewBox="0 0 100 100" class="h-full w-full">
                        <path d="M50 5 L90 27.5 L90 72.5 L50 95 L10 72.5 L10 27.5 Z" fill="none" stroke="currentColor"
                            stroke-width="12" stroke-linejoin="round" />
                        <path d="M50 35 L70 46.5 L70 67.5 L50 79 L30 67.5 L30 46.5 Z" fill="currentColor" />
                    </svg>
                </div>
                <h2 class="text-xl font-bold text-gray-800">MISL ERP Support Tracking System</h2>
                <p class="text-sm text-gray-500 mt-2">Authorized Personnel Only</p>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Username</label>
                    <div class="relative">
                        <input type="text" id="login-username" placeholder="Enter Username (e.g. Ravish)"
                            class="w-full pl-10 pr-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:bg-white focus:ring-2 focus:ring-brand-500 outline-none font-medium text-gray-700">
                        <i class="fa-solid fa-user absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Password</label>
                    <div class="relative">
                        <input type="password" id="login-password" placeholder="Enter Password"
                            class="w-full pl-10 pr-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:bg-white focus:ring-2 focus:ring-brand-500 outline-none font-medium text-gray-700">
                        <i class="fa-solid fa-key absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>

                <button onclick="app.login()"
                    class="w-full py-3.5 rounded-xl bg-brand-600 text-white font-bold hover:bg-brand-700 active:scale-95 transition-all shadow-lg hover:shadow-brand-500/30 mt-4">
                    Login
                    <i class="fa-solid fa-arrow-right ml-2"></i>
                </button>

                <div id="login-error"
                    class="hidden text-center text-red-500 text-sm mt-3 font-medium bg-red-50 py-2 rounded-lg">
                    Incorrect Username or Password.
                </div>
            </div>

            <p class="text-center text-xs text-gray-400 mt-8">
                Default Admin PIN: <span class="font-mono bg-gray-100 px-1 rounded">123</span>
            </p>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="add-user-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-md p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="add-user-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">New User</h3>
                    <p class="text-xs text-slate-400 mt-1">Create a new system account</p>
                </div>
                <button onclick="app.closeAddUserModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <div class="space-y-6">
                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Full
                        Name</label>
                    <input type="text" id="new-user-name" placeholder="Enter Full Name"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500/10 focus:border-brand-500 outline-none transition-all font-medium">
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Set 4-Digit
                        PIN</label>
                    <input type="password" id="new-user-pin" placeholder="****" maxlength="4"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500/10 focus:border-brand-500 outline-none transition-all font-medium">
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">User
                        Role</label>
                    <select id="new-user-role"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500/10 focus:border-brand-500 outline-none transition-all font-medium">
                        <option value="agent">Agent (Standard)</option>
                        <option value="admin">Admin (Full Access)</option>
                    </select>
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-3">Menu
                        Permissions</label>
                    <div class="grid grid-cols-2 gap-3 bg-slate-50 p-4 rounded-2xl border border-slate-100">
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="dashboard" checked
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Dashboard
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="calls" checked
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Calls
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="activities" checked
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Tasks
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="tickets" checked
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Tickets
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="casenotes" checked
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Case Notes
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="departments" checked
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500">
                            Departments
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="permission" value="users"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> User Mgmt
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-3">Department
                        Access</label>
                    <div id="new-user-departments"
                        class="grid grid-cols-2 gap-3 bg-slate-50 p-4 rounded-2xl border border-slate-100 max-h-40 overflow-y-auto custom-scrollbar">
                        <!-- Populated dynamically -->
                    </div>
                </div>

                <div class="flex gap-3">
                    <button onclick="app.closeAddUserModal()"
                        class="flex-1 px-6 py-3.5 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all">
                        Cancel
                    </button>
                    <button onclick="app.createUser()"
                        class="flex-[2] bg-brand-500 text-white font-bold py-3.5 rounded-xl hover:bg-brand-600 transition-all shadow-lg shadow-brand-500/20 active:scale-95">
                        Create Account
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="edit-user-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-md p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="edit-user-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">Edit User</h3>
                    <p class="text-xs text-slate-400 mt-1">Update account details and access</p>
                </div>
                <button onclick="app.closeEditUserModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <div class="space-y-6">
                <input type="hidden" id="edit-user-id">
                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Full
                        Name</label>
                    <input type="text" id="edit-user-name" placeholder="Full Name"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500/10 focus:border-brand-500 outline-none transition-all font-medium">
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">PIN
                        (Password)</label>
                    <input type="text" id="edit-user-pin" placeholder="****" maxlength="4"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-brand-500/10 focus:border-brand-500 outline-none transition-all font-medium">
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-3">Menu
                        Permissions</label>
                    <div class="grid grid-cols-2 gap-3 bg-slate-50 p-4 rounded-2xl border border-slate-100">
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="dashboard"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Dashboard
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="calls"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Calls
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="activities"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Tasks
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="tickets"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Tickets
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="casenotes"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> Case Notes
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="departments"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500">
                            Departments
                        </label>
                        <label class="flex items-center gap-2 text-sm font-medium text-slate-600 cursor-pointer">
                            <input type="checkbox" name="edit-permission" value="users"
                                class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"> User Mgmt
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-3">Department
                        Access</label>
                    <div id="edit-user-departments"
                        class="grid grid-cols-2 gap-3 bg-slate-50 p-4 rounded-2xl border border-slate-100 max-h-40 overflow-y-auto custom-scrollbar">
                        <!-- Populated dynamically -->
                    </div>
                </div>

                <div class="flex gap-3">
                    <button onclick="app.closeEditUserModal()"
                        class="flex-1 px-6 py-3.5 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all">
                        Cancel
                    </button>
                    <button onclick="app.updateUser()"
                        class="flex-[2] bg-brand-500 text-white font-bold py-3.5 rounded-xl hover:bg-brand-600 transition-all shadow-lg shadow-brand-500/20 active:scale-95">
                        Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Player Modal (Hidden by default) -->
    <div id="audio-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300">
        <div class="glass w-full max-w-md p-6 rounded-2xl transform scale-95 transition-transform duration-300"
            id="audio-modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800" id="modal-client-name">Recording Playback</h3>
                <button onclick="app.closeAudioModal()" class="text-gray-400 hover:text-red-500 transition-colors">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>
            <div class="bg-gray-100 rounded-xl p-4 mb-4 flex justify-center">
                <audio id="main-audio-player" controls class="w-full"></audio>
            </div>
            <div class="flex gap-2 justify-end">
                <button onclick="app.deleteCurrentRecording()"
                    class="text-red-500 hover:bg-red-50 py-2 px-4 rounded-lg text-sm font-medium transition-colors">Delete</button>
                <button onclick="app.createTicketFromRecording()"
                    class="bg-brand-500 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-brand-600 transition-colors shadow-lg shadow-brand-500/20">Create
                    Ticket</button>
            </div>
        </div>
    </div>

    <!-- Edit Ticket Modal -->
    <div id="edit-ticket-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-2xl p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="edit-ticket-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">Edit Ticket</h3>
                    <p class="text-xs text-slate-400 mt-1">Update ticket details and status</p>
                </div>
                <button onclick="app.closeEditTicketModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <input type="hidden" id="edit-ticket-id">

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Standard Fields -->
                <div class="md:col-span-2">
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Client
                        Name</label>
                    <input type="text" id="edit-ticket-client" placeholder="Client Name"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>

                <div class="md:col-span-2">
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Checklist &
                        Progress</label>
                    <div id="edit-ticket-checklist-container"
                        class="space-y-3 mb-4 bg-slate-50/50 p-4 rounded-2xl border border-slate-100 max-h-60 overflow-y-auto custom-scrollbar">
                        <!-- Checklist items will be injected here -->
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="edit-ticket-new-point"
                            placeholder="Add a task or update (e.g. Call scheduled)"
                            onkeydown="if(event.key === 'Enter') { event.preventDefault(); app.addChecklistItem('edit'); }"
                            class="flex-1 px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium bg-white">
                        <button onclick="app.addChecklistItem('edit')"
                            class="px-5 py-3 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition-all font-bold shadow-sm active:scale-95">
                            <i class="fa-solid fa-plus mr-1"></i> Add
                        </button>
                    </div>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Assignee</label>
                    <select id="edit-ticket-assignee"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="">Unassigned</option>
                    </select>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Priority</label>
                    <select id="edit-ticket-priority"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="Low">Low</option>
                        <option value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Status</label>
                    <select id="edit-ticket-status"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="Open">Open</option>
                        <option value="Closed">Closed</option>
                    </select>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Department</label>
                    <select id="edit-ticket-department"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="">No Department</option>
                    </select>
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Date</label>
                    <input type="date" id="edit-ticket-date"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Duration
                        (Hours)</label>
                    <input type="number" id="edit-ticket-duration" placeholder="e.g. 2.5" step="0.25" min="0"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>
            </div>

            <div class="mt-8 flex gap-3">
                <button onclick="app.closeEditTicketModal()"
                    class="flex-1 px-6 py-4 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all active:scale-95">
                    Discard
                </button>
                <button onclick="app.updateTicket()"
                    class="flex-[2] bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100 active:scale-95">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Call Modal -->
    <div id="edit-call-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-md p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="edit-call-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">Edit Recording</h3>
                    <p class="text-xs text-slate-400 mt-1">Update recording details</p>
                </div>
                <button onclick="app.closeEditCallModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>
            <div class="space-y-6">
                <input type="hidden" id="edit-call-id">
                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Client
                        Name</label>
                    <input type="text" id="edit-call-client"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>
                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Date</label>
                    <input type="date" id="edit-call-date"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>
                <div class="flex gap-3">
                    <button onclick="app.closeEditCallModal()"
                        class="flex-1 px-6 py-4 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all">
                        Cancel
                    </button>
                    <button onclick="app.updateCall()"
                        class="flex-[2] bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100">
                        Update Recording
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Department Modal -->
    <div id="edit-department-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-md p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="edit-department-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">Edit Department</h3>
                    <p class="text-xs text-slate-400 mt-1">Update department name</p>
                </div>
                <button onclick="app.closeEditDepartmentModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>
            <div class="space-y-6">
                <input type="hidden" id="edit-department-id">
                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Department
                        Name</label>
                    <input type="text" id="edit-department-name"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>
                <div class="flex gap-3">
                    <button onclick="app.closeEditDepartmentModal()"
                        class="flex-1 px-6 py-4 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all">
                        Cancel
                    </button>
                    <button onclick="app.updateDepartment()"
                        class="flex-[2] bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100">
                        Update Name
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Task Modal -->
    <div id="edit-task-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-md p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="edit-task-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">Edit Task</h3>
                    <p class="text-xs text-slate-400 mt-1">Update task title</p>
                </div>
                <button onclick="app.closeEditTaskModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>
            <div class="space-y-6">
                <input type="hidden" id="edit-task-id">
                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Task
                        Title</label>
                    <input type="text" id="edit-task-title"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>
                <div class="flex gap-3">
                    <button onclick="app.closeEditTaskModal()"
                        class="flex-1 px-6 py-4 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all">
                        Cancel
                    </button>
                    <button onclick="app.updateTask()"
                        class="flex-[2] bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100">
                        Update Task
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Ticket Modal -->
    <div id="add-ticket-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div class="glass w-full max-w-2xl p-8 rounded-3xl transform scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar"
            id="add-ticket-modal-content">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">New Support Ticket</h3>
                    <p class="text-xs text-slate-400 mt-1">Fill in the details to create a new ticket</p>
                </div>
                <button onclick="app.closeAddTicketModal()"
                    class="h-10 w-10 rounded-xl bg-slate-100 text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="md:col-span-2">
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Client
                        Name</label>
                    <input type="text" id="add-ticket-client" placeholder="e.g. Perera & Sons"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>

                <div class="md:col-span-2">
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Ticket
                        Points (Task List)</label>
                    <div id="add-ticket-checklist-container"
                        class="space-y-3 mb-4 bg-slate-50/50 p-4 rounded-2xl border border-slate-100 max-h-40 overflow-y-auto custom-scrollbar">
                        <!-- Initial points will be here -->
                        <p class="text-[11px] text-slate-400 italic text-center py-2">Add points using the box below</p>
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="add-ticket-new-point"
                            placeholder="What needs to be done? (e.g. Server restart)"
                            onkeydown="if(event.key === 'Enter') { event.preventDefault(); app.addChecklistItem('add'); }"
                            class="flex-1 px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium bg-white">
                        <button onclick="app.addChecklistItem('add')"
                            class="px-5 py-3 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition-all font-bold shadow-sm active:scale-95">
                            <i class="fa-solid fa-plus mr-1"></i> Add
                        </button>
                    </div>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Assignee</label>
                    <select id="add-ticket-assignee"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="">Unassigned</option>
                    </select>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Priority</label>
                    <select id="add-ticket-priority"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="Low">Low</option>
                        <option value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                </div>

                <div>
                    <label
                        class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Department</label>
                    <select id="add-ticket-department"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:1em_1em]"
                        style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');">
                        <option value="">No Department</option>
                    </select>
                </div>

                <div>
                    <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Date</label>
                    <input type="date" id="add-ticket-date"
                        class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all font-medium">
                </div>
            </div>

            <div class="mt-8 flex gap-3">
                <button onclick="app.closeAddTicketModal()"
                    class="flex-1 px-6 py-4 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-all active:scale-95">
                    Cancel
                </button>
                <button onclick="app.createTicket()"
                    class="flex-[2] bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100 active:scale-95">
                    Create Ticket
                </button>
            </div>
        </div>
    </div>

    <!-- Case Note Modal -->
    <div id="casenote-modal"
        class="fixed inset-0 bg-white/10 backdrop-blur-md z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300 py-4">
        <div id="casenote-modal-content"
            class="glass w-full max-w-lg p-8 rounded-[2.5rem] shadow-2xl border border-white scale-95 transition-transform duration-300 max-h-[95vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800" id="casenote-modal-title">New Case Note</h3>
                <button onclick="app.closeCaseNoteModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>
            <div class="space-y-4">
                <input type="hidden" id="casenote-id">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Date</label>
                        <input type="date" id="casenote-date"
                            class="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-brand-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Case Type</label>
                        <select id="casenote-type"
                            class="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-brand-500 outline-none">
                            <option value="Technical">Technical</option>
                            <option value="Billing">Billing</option>
                            <option value="General">General</option>
                            <option value="Inquiry">Inquiry</option>
                            <option value="Update">Update</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Client</label>
                    <input type="text" id="casenote-client" placeholder="Client Name"
                        class="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-brand-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Case Notes</label>
                    <textarea id="casenote-content" rows="6" placeholder="Describe the work done..."
                        class="w-full p-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-brand-500 outline-none resize-none"></textarea>
                </div>
                <button onclick="app.saveCaseNote()"
                    class="w-full bg-brand-600 text-white font-bold py-3 rounded-xl hover:bg-brand-700 transition-colors shadow-lg shadow-brand-500/20">
                    Save Note
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="db.js"></script>
    <script src="app.js"></script>
</body>

</html>